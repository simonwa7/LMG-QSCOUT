(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    182482,       4853]
NotebookOptionsPosition[    180798,       4817]
NotebookOutlinePosition[    181368,       4839]
CellTagsIndexPosition[    181295,       4834]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Sandia QSCOUT Data Analysis 1 Qubit Version",
  FontSize->36],
 "\n\n\tFirst, run the library at the bottom. Then you can tweak the Main \
Cells. In all cases, we\[CloseCurlyQuote]re preparing states of the LMG model \
with V=Sqrt[3], W = Sqrt[2] and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "a"], "=", 
    RowBox[{
     SubscriptBox["\[Nu]", "b"], "=", "0"}]}], TraditionalForm]],
  ExpressionUUID->"cd0c7c0e-ffea-4479-a415-899bf833ae62"],
 ". The data was run on a JAQAL simulator with some noise. Measurements were \
done in the clique format. Shot numbers were ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["2", "8"], TraditionalForm]],ExpressionUUID->
  "d9609c3f-c614-4524-b0f8-5c1053c2ad7e"],
 " but the data was saved in a \[OpenCurlyDoubleQuote]single-estimate\
\[CloseCurlyDoubleQuote] format. This is different than the IBM ones which \
had ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["2", "13"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "9c51bc2f-cf84-4646-912b-cac7c8cb3abc"],
 " each.\n\t\n\tInstructions: \n\t1.) Run the Library cell.\n\t2.) Put in the \
correct filepaths for the 1-, 2- and 3-qubit single state preparation files. \
These are fp1, fp2 and fp3 in the Main Cell.\n\t3.) Run the main cell!"
}], "Text",
 CellChangeTimes->{{3.852025896765571*^9, 3.852025912467201*^9}, {
  3.8520260518293047`*^9, 3.852026112741128*^9}, {3.8520261621853848`*^9, 
  3.852026172359151*^9}, {3.8520262690703278`*^9, 3.852026357265006*^9}, {
  3.852027030755372*^9, 3.852027031748909*^9}, {3.8520294134897003`*^9, 
  3.852029429029481*^9}, {3.852029461278797*^9, 3.852029462145836*^9}, {
  3.852029833908095*^9, 
  3.852029948799678*^9}},ExpressionUUID->"cae858d2-540d-4608-8d21-\
c3f0aeb362fc"],

Cell[TextData[{
 StyleBox["\tSingle Point Preparation:",
  FontSize->48],
 "\n\tThis cell takes the files you feed it, analyzes them and outputs some \
data visualizations. The expectation values are -0.6158\[Epsilon] for 1 \
qubit, -1.6164\[Epsilon] for 2 qubits and -2.6286 for 3 qubits."
}], "Text",
 CellChangeTimes->{{3.8520262509571333`*^9, 3.85202626674552*^9}, {
  3.852026302511034*^9, 3.8520263145139437`*^9}, {3.852026403530552*^9, 
  3.8520264051225357`*^9}, {3.852026842581357*^9, 3.852026848309*^9}, {
  3.852026998254258*^9, 3.85202702014793*^9}, {3.852027341274199*^9, 
  3.852027347106398*^9}, {3.852029364478279*^9, 
  3.8520294556885843`*^9}},ExpressionUUID->"6da49c1c-df50-4d22-8483-\
42ac4fc22049"],

Cell[BoxData[
 RowBox[{"\t\t\t\t\t", 
  RowBox[{
   StyleBox["(*",
    FontSize->18], 
   StyleBox[" ",
    FontSize->48], 
   StyleBox[
    RowBox[{"Main", " ", "Cell"}],
    FontSize->48], 
   StyleBox[" ",
    FontSize->48], 
   StyleBox["*)",
    FontSize->18]}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"pldata", ",", "rerror"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pldata", "[", 
     RowBox[{"explist_", ",", "spacing_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"step1", "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"explist", ",", "spacing"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"step1", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", 
            RowBox[{"1", ";;", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"step1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}]}], "]"}], 
          "]"}], ",", 
         FractionBox[
          RowBox[{"step1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], 
          RowBox[{"Total", "[", 
           RowBox[{"step1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]]}], "}"}], "]"}]}], ")"}]}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rerror", "[", 
      RowBox[{"expected_", ",", "observed_"}], "]"}], ":=", 
     RowBox[{"Abs", "[", 
      FractionBox[
       RowBox[{"observed", "-", "expected"}], "expected"], "]"}]}], ";", " ", 
    
    RowBox[{"(*", " ", 
     RowBox[{"The", " ", "relative", " ", 
      RowBox[{"error", "'"}], "s", " ", "absolute", " ", 
      RowBox[{"value", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
    "fp1", "=", 
     "\"\</Users/krobbi02/Documents/QI_Research/SandiaFolder/NoisyJaqalData/\
point/1/single_point_eval.txt\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"1", " ", 
     RowBox[{"QUBIT", ":", " ", 
      RowBox[{
      "Where", " ", "to", " ", "find", " ", "the", " ", "datafile", " ", 
       "you", " ", "want", " ", "to", " ", 
       RowBox[{"read", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "fp2", "=", 
     "\"\</Users/krobbi02/Documents/QI_Research/SandiaFolder/NoisyJaqalData/\
point/2/single_point_eval.txt\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"1", " ", 
     RowBox[{"QUBIT", ":", " ", 
      RowBox[{
      "Where", " ", "to", " ", "find", " ", "the", " ", "datafile", " ", 
       "you", " ", "want", " ", "to", " ", 
       RowBox[{"read", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "fp3", "=", 
     "\"\</Users/krobbi02/Documents/QI_Research/SandiaFolder/NoisyJaqalData/\
point/3/single_point_eval.txt\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"1", " ", 
     RowBox[{"QUBIT", ":", " ", 
      RowBox[{
      "Where", " ", "to", " ", "find", " ", "the", " ", "datafile", " ", 
       "you", " ", "want", " ", "to", " ", 
       RowBox[{"read", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"th1", "=", 
     RowBox[{"-", "0.6157688743457477"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "The", " ", "theoretical", " ", "expectation", " ", "value", " ", "for", 
      " ", "1", " ", 
      RowBox[{"qubit", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"th2", "=", 
     RowBox[{"-", "1.6164000911382201"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "The", " ", "theoretical", " ", "expectation", " ", "value", " ", "for", 
      " ", "2", " ", 
      RowBox[{"qubits", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"th3", "=", 
     RowBox[{"-", "2.6286138040619313"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "The", " ", "theoretical", " ", "expectation", " ", "value", " ", "for", 
      " ", "3", " ", 
      RowBox[{"qubits", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"V", "=", 
     RowBox[{"Sqrt", "[", "3.", "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Sets", " ", "the", " ", "strength", " ", "of", " ", "the", " ", "V", 
      " ", "interaction", " ", 
      RowBox[{"parameter", ".", " ", "The"}], " ", "interesting", " ", 
      RowBox[{"one", "!"}], " ", 
      RowBox[{"Don", "'"}], "t", " ", "change", " ", "unless", " ", "you", 
      " ", "change", " ", "it", " ", "in", " ", "the", " ", 
      RowBox[{"code", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"W", "=", 
     RowBox[{"Sqrt", "[", "2.", "]"}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Sets", " ", "the", " ", "strength", " ", "of", " ", "the", " ", "W", 
      " ", "interaction", " ", 
      RowBox[{"parameter", ".", " ", 
       RowBox[{"Don", "'"}]}], "t", " ", "change", " ", "unless", " ", "you", 
      " ", "change", " ", "it", " ", "in", " ", "the", " ", 
      RowBox[{"code", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Nu]a", "=", "0"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Sets", " ", "the", " ", "number", " ", "of", " ", "unpaired", " ", 
      "particles", " ", "in", " ", "the", " ", "\"\<a\>\"", " ", "mode", " ", 
      "to", " ", "0.", " ", 
      RowBox[{"Don", "'"}], "t", " ", "change", " ", "unless", " ", "you", 
      " ", "change", " ", "it", " ", "in", " ", "the", " ", 
      RowBox[{"code", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Nu]b", "=", "0"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Sets", " ", "the", " ", "number", " ", "of", " ", "unpaired", " ", 
      "particles", " ", "in", " ", "the", " ", "\"\<b\>\"", " ", "mode", " ", 
      "to", " ", "0.", " ", 
      RowBox[{"Don", "'"}], "t", " ", "change", " ", "unless", " ", "you", 
      " ", "change", " ", "it", " ", "in", " ", "the", " ", 
      RowBox[{"code", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    StyleBox[
     RowBox[{"(*", " ", 
      RowBox[{"Analyzing", " ", "1", " ", "Qubit", " ", "Data"}], " ", "*)"}],
     
     FontSize->18], "\[IndentingNewLine]", 
    RowBox[{"stringlist", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ReadString", "[", "fp1", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
          RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}], ",", 
          RowBox[{"\"\<'\>\"", "\[Rule]", "\"\<\\\"\>\""}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listlist1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"stringlist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "\"\<\>\""}], 
          "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "stringlist", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"stringlist", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Prepping", " ", "the", " ", "string", " ", "for", " ", "digestion", " ", 
     "by", " ", 
     RowBox[{"outputeaters", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reslist1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"outputeater1", "[", 
         RowBox[{"listlist1", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "i"}], "]"}], "]"}], "]"}], "+", 
        RowBox[{"outputeater2", "[", 
         RowBox[{"listlist1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"listlist1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"List", " ", "of", " ", "1"}], "-", 
      RowBox[{"qubit", " ", 
       RowBox[{"\[LeftAngleBracket]", "H", "\[RightAngleBracket]"}], " ", 
       RowBox[{"estimates", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    StyleBox[
     RowBox[{"(*", " ", 
      RowBox[{"Analyzing", " ", "2", " ", "Qubit", " ", "Data"}], " ", "*)"}],
     
     FontSize->18], "\[IndentingNewLine]", 
    RowBox[{"stringlist", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ReadString", "[", "fp2", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
          RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}], ",", 
          RowBox[{"\"\<'\>\"", "\[Rule]", "\"\<\\\"\>\""}]}], "}"}]}], "]"}], 
      "]"}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Prepping", " ", "the", " ", "string", " ", "for", " ", "digestion", " ",
       "by", " ", 
      RowBox[{"outputeaters", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"listlist2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"stringlist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "\"\<\>\""}], 
          "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "stringlist", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"stringlist", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reslist2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"outputeater1", "[", 
         RowBox[{"listlist2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "i"}], "]"}], "]"}], "]"}], "+", 
        RowBox[{"outputeater2", "[", 
         RowBox[{"listlist2", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], "+", 
        RowBox[{"outputeater3", "[", 
         RowBox[{"listlist2", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"listlist2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"List", " ", "of", " ", "2"}], "-", 
      RowBox[{"qubit", " ", 
       RowBox[{"\[LeftAngleBracket]", "H", "\[RightAngleBracket]"}], " ", 
       RowBox[{"estimates", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    StyleBox[
     RowBox[{"(*", " ", 
      RowBox[{"Analyzing", " ", "3", " ", "Qubit", " ", "Data"}], " ", "*)"}],
     
     FontSize->18], "\[IndentingNewLine]", 
    RowBox[{"stringlist", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ReadString", "[", "fp3", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
          RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}], ",", 
          RowBox[{"\"\<'\>\"", "\[Rule]", "\"\<\\\"\>\""}]}], "}"}]}], "]"}], 
      "]"}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Prepping", " ", "the", " ", "string", " ", "for", " ", "digestion", " ",
       "by", " ", 
      RowBox[{"outputeaters", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"listlist3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"stringlist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "\"\<\>\""}], 
          "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "stringlist", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"stringlist", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reslist3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"outputeater1", "[", 
         RowBox[{"listlist3", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "i"}], "]"}], "]"}], "]"}], "+", 
        RowBox[{"outputeater2", "[", 
         RowBox[{"listlist3", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], "+", 
        RowBox[{"outputeater3", "[", 
         RowBox[{"listlist3", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "i"}], "]"}], "]"}], "]"}], "+", 
        RowBox[{"outputeater4", "[", 
         RowBox[{"listlist3", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"listlist3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"List", " ", "of", " ", "3"}], "-", 
      RowBox[{"qubit", " ", 
       RowBox[{"\[LeftAngleBracket]", "H", "\[RightAngleBracket]"}], " ", 
       RowBox[{"estimates", "."}]}]}], " ", "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.852026417616918*^9, 3.8520265610181847`*^9}, {
  3.852026602980832*^9, 3.852026671719925*^9}, {3.852026750860544*^9, 
  3.852026808657971*^9}, {3.852027034285055*^9, 3.852027065146058*^9}, {
  3.852027351808251*^9, 3.852027709522085*^9}, {3.85202787585181*^9, 
  3.852027889289349*^9}, {3.8520279525826387`*^9, 3.852028022465837*^9}, {
  3.852028064914689*^9, 3.852028111191762*^9}, {3.8520286558979807`*^9, 
  3.852028662676731*^9}, {3.852028912134903*^9, 3.852028953433939*^9}, {
  3.852029129767432*^9, 3.8520291363710814`*^9}, {3.8520298931446943`*^9, 
  3.8520299128861217`*^9}},ExpressionUUID->"084df1b7-e6b3-4160-9f31-\
0113e7ea164e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"Visualizing", " ", "Data"}], " ", "*)"}],
   FontSize->36], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"\"\<The 1-Qubit data had an expectation value of \>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Mean", "[", "reslist1", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<\[Epsilon] which has a relative error of \>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"100", "*", 
          FractionBox[
           RowBox[{
            RowBox[{"Mean", "[", "reslist1", "]"}], "-", "th1"}], "th1"]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<%.\>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"\"\<The 2-Qubit data had an expectation value of \>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Mean", "[", "reslist2", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<\[Epsilon] which has a relative error of \>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"100", "*", 
          FractionBox[
           RowBox[{
            RowBox[{"Mean", "[", "reslist2", "]"}], "-", "th2"}], "th2"]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<%.\>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"\"\<The 3-Qubit data had an expectation value of \>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Mean", "[", "reslist3", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<\[Epsilon] which has a relative error of \>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"100", "*", 
          FractionBox[
           RowBox[{
            RowBox[{"Mean", "[", "reslist3", "]"}], "-", "th3"}], "th3"]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<%.\>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bw", "=", 
     RowBox[{"{", ".5", "}"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Pick", " ", "a", " ", "bin", " ", 
      RowBox[{"width", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"tf", "=", "25"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Plot", " ", "title", " ", 
      RowBox[{"(", "label", ")"}], " ", "font", " ", 
      RowBox[{"size", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"af", "=", "17"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{"Axes", " ", "label", " ", "font", " ", 
      RowBox[{"size", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"pldata", "[", 
       RowBox[{"reslist1", ",", "bw"}], "]"}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<Sampled \[LeftAngleBracket]H\[RightAngleBracket] Value\>\"", 
           ",", 
           RowBox[{"FontSize", "\[Rule]", "af"}]}], "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<Sampled \[LeftAngleBracket]H\[RightAngleBracket] Probability\>\
\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "af"}]}], "]"}]}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<1-Qubit LMG \[LeftAngleBracket]H\[RightAngleBracket] Estimates\>\
\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "tf"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"pldata", "[", 
      RowBox[{"reslist2", ",", "bw"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Sampled \[LeftAngleBracket]H\[RightAngleBracket] Value\>\"", 
          ",", 
          RowBox[{"FontSize", "\[Rule]", "af"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Sampled \[LeftAngleBracket]H\[RightAngleBracket] \
Probability\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "af"}]}], "]"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<2-Qubit LMG \[LeftAngleBracket]H\[RightAngleBracket] \
Estimates\>\"", ",", 
        RowBox[{"FontSize", "\[Rule]", "tf"}]}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"pldata", "[", 
      RowBox[{"reslist3", ",", "bw"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Sampled \[LeftAngleBracket]H\[RightAngleBracket] Value\>\"", 
          ",", 
          RowBox[{"FontSize", "\[Rule]", "af"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Sampled \[LeftAngleBracket]H\[RightAngleBracket] \
Probability\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "af"}]}], "]"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<3-Qubit LMG \[LeftAngleBracket]H\[RightAngleBracket] \
Estimates\>\"", ",", 
        RowBox[{"FontSize", "\[Rule]", "tf"}]}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"rerror", "[", 
          RowBox[{"th1", ",", 
           RowBox[{"Mean", "[", "reslist1", "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"rerror", "[", 
          RowBox[{"th2", ",", 
           RowBox[{"Mean", "[", "reslist2", "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", 
         RowBox[{"rerror", "[", 
          RowBox[{"th3", ",", 
           RowBox[{"Mean", "[", "reslist3", "]"}]}], "]"}]}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Qubit Number\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "af"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<|Relative Error of \
\[LeftAngleBracket]H\[RightAngleBracket]|\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "af"}]}], "]"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<LMG \[LeftAngleBracket]H\[RightAngleBracket] Estimates By Qubit \
Count\>\"", ",", 
        RowBox[{"FontSize", "\[Rule]", "tf"}]}], "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.15"}], "}"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.852027714752021*^9, 3.8520277376202793`*^9}, {
  3.852027787448875*^9, 3.852027790138332*^9}, {3.852028126862096*^9, 
  3.8520281291960173`*^9}, {3.8520285671796837`*^9, 3.852028607442326*^9}, {
  3.8520286481243763`*^9, 3.852028906572157*^9}, {3.852028964653043*^9, 
  3.852029031725752*^9}, {3.852029091336253*^9, 3.852029119955887*^9}, {
  3.8520291697199383`*^9, 3.852029242375614*^9}, {3.8520293211930857`*^9, 
  3.852029343402975*^9}, {3.85202948455801*^9, 3.852029509182086*^9}, {
  3.852029556043885*^9, 3.852029801404902*^9}, {3.8520304610460367`*^9, 
  3.852030468795227*^9}},
 CellLabel->
  "In[505]:=",ExpressionUUID->"7027a292-97fc-4674-9fcf-00f9b2c60ed1"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"The 1-Qubit data had an expectation value of \"\>",
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{"-", "0.6138015073823201`"}],
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Epsilon] which has a relative error of \"\>",
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     InterpretationBox[
      StyleBox["\<\"-0.3\"\>",
       ShowStringCharacters->False],
      -0.31949763058711056`,
      AutoDelete->True],
     NumberForm[#, {5, 1}]& ],
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox["\<\"%.\"\>",
    StripOnInput->False,
    FontSize->25]}],
  SequenceForm[
   Style["The 1-Qubit data had an expectation value of ", FontSize -> 25], 
   Style[-0.6138015073823201, FontSize -> 25], 
   Style["\[Epsilon] which has a relative error of ", FontSize -> 25], 
   Style[
    NumberForm[-0.31949763058711056`, {5, 1}], FontSize -> 25], 
   Style["%.", FontSize -> 25]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.852029612589341*^9, {3.8520296957478228`*^9, 3.852029716452311*^9}, {
   3.852029756133318*^9, 3.85202980179107*^9}, 3.852030469549593*^9},
 CellLabel->
  "During evaluation of \
In[505]:=",ExpressionUUID->"82fc8dd0-2728-4152-bf33-224a00cf93d9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"The 2-Qubit data had an expectation value of \"\>",
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{"-", "1.4812063156951443`"}],
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Epsilon] which has a relative error of \"\>",
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     InterpretationBox[
      StyleBox["\<\"-8.4\"\>",
       ShowStringCharacters->False],
      -8.363880711481308,
      AutoDelete->True],
     NumberForm[#, {5, 1}]& ],
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox["\<\"%.\"\>",
    StripOnInput->False,
    FontSize->25]}],
  SequenceForm[
   Style["The 2-Qubit data had an expectation value of ", FontSize -> 25], 
   Style[-1.4812063156951443`, FontSize -> 25], 
   Style["\[Epsilon] which has a relative error of ", FontSize -> 25], 
   Style[
    NumberForm[-8.363880711481308, {5, 1}], FontSize -> 25], 
   Style["%.", FontSize -> 25]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.852029612589341*^9, {3.8520296957478228`*^9, 3.852029716452311*^9}, {
   3.852029756133318*^9, 3.85202980179107*^9}, 3.852030469552101*^9},
 CellLabel->
  "During evaluation of \
In[505]:=",ExpressionUUID->"bbfe762e-e9af-4131-8bee-3158a2b9a7a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"The 3-Qubit data had an expectation value of \"\>",
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{"-", "2.2004052023101006`"}],
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Epsilon] which has a relative error of \"\>",
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     InterpretationBox[
      StyleBox["\<\"-16.3\"\>",
       ShowStringCharacters->False],
      -16.29028201442641,
      AutoDelete->True],
     NumberForm[#, {5, 1}]& ],
    StripOnInput->False,
    FontSize->25], "\[InvisibleSpace]", 
   StyleBox["\<\"%.\"\>",
    StripOnInput->False,
    FontSize->25]}],
  SequenceForm[
   Style["The 3-Qubit data had an expectation value of ", FontSize -> 25], 
   Style[-2.2004052023101006`, FontSize -> 25], 
   Style["\[Epsilon] which has a relative error of ", FontSize -> 25], 
   Style[
    NumberForm[-16.29028201442641, {5, 1}], FontSize -> 25], 
   Style["%.", FontSize -> 25]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.852029612589341*^9, {3.8520296957478228`*^9, 3.852029716452311*^9}, {
   3.852029756133318*^9, 3.85202980179107*^9}, 3.852030469553426*^9},
 CellLabel->
  "During evaluation of \
In[505]:=",ExpressionUUID->"f02541e2-1a01-4a92-97c2-51dfcd67c389"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     LineBox[{{-1.5, 0.73046875}, {-1., 0.}, {-0.5, 0.}, {0., 0.}, {0.5, 
      0.24609375}, {1., 0.}, {1.5, 0.}, {2., 0.}, {2.5, 
      0.0234375}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     StyleBox[
     "\"Sampled \[LeftAngleBracket]H\[RightAngleBracket] Value\"", FontSize -> 
      17, StripOnInput -> False], TraditionalForm], 
    FormBox[
     StyleBox[
     "\"Sampled \[LeftAngleBracket]H\[RightAngleBracket] Probability\"", 
      FontSize -> 17, StripOnInput -> False], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox[
    "\"1-Qubit LMG \[LeftAngleBracket]H\[RightAngleBracket] Estimates\"", 
     FontSize -> 25, StripOnInput -> False], TraditionalForm],
  PlotRange->{{-1.5, 2.5}, {0, 0.73046875}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.852027725324094*^9, 3.85202773971369*^9}, 
   3.852027790506556*^9, {3.852028123295957*^9, 3.8520281295581617`*^9}, {
   3.852028677126625*^9, 3.8520287192736797`*^9}, 3.8520287497891197`*^9, {
   3.852028820912098*^9, 3.852028889996634*^9}, {3.852029023498476*^9, 
   3.85202903199303*^9}, {3.852029096233757*^9, 3.8520291441199427`*^9}, {
   3.852029188432682*^9, 3.852029203305828*^9}, {3.852029235023405*^9, 
   3.852029242950612*^9}, 3.852029343765148*^9, 3.852029612621873*^9, {
   3.852029695771638*^9, 3.85202971648778*^9}, {3.8520297561534224`*^9, 
   3.852029801818596*^9}, 3.852030469585528*^9},
 CellLabel->
  "Out[508]=",ExpressionUUID->"f3e1a9ff-225c-4a9c-85c2-62022d7474c5"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     LineBox[{{-3.5, 0.1328125}, {-3., 0.1796875}, {-2.5, 0.08203125}, {-2., 
      0.16015625}, {-1.5, 0.15234375}, {-1., 0.05859375}, {-0.5, 0.046875}, {
      0., 0.07421875}, {0.5, 0.02734375}, {1., 0.015625}, {1.5, 0.015625}, {
      2., 0.03515625}, {2.5, 0.00390625}, {3., 0.00390625}, {3.5, 0.}, {4., 
      0.01171875}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     StyleBox[
     "\"Sampled \[LeftAngleBracket]H\[RightAngleBracket] Value\"", FontSize -> 
      17, StripOnInput -> False], TraditionalForm], 
    FormBox[
     StyleBox[
     "\"Sampled \[LeftAngleBracket]H\[RightAngleBracket] Probability\"", 
      FontSize -> 17, StripOnInput -> False], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox[
    "\"2-Qubit LMG \[LeftAngleBracket]H\[RightAngleBracket] Estimates\"", 
     FontSize -> 25, StripOnInput -> False], TraditionalForm],
  PlotRange->{{-3.5, 4.}, {0, 0.1796875}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.852027725324094*^9, 3.85202773971369*^9}, 
   3.852027790506556*^9, {3.852028123295957*^9, 3.8520281295581617`*^9}, {
   3.852028677126625*^9, 3.8520287192736797`*^9}, 3.8520287497891197`*^9, {
   3.852028820912098*^9, 3.852028889996634*^9}, {3.852029023498476*^9, 
   3.85202903199303*^9}, {3.852029096233757*^9, 3.8520291441199427`*^9}, {
   3.852029188432682*^9, 3.852029203305828*^9}, {3.852029235023405*^9, 
   3.852029242950612*^9}, 3.852029343765148*^9, 3.852029612621873*^9, {
   3.852029695771638*^9, 3.85202971648778*^9}, {3.8520297561534224`*^9, 
   3.852029801818596*^9}, 3.85203046960986*^9},
 CellLabel->
  "Out[509]=",ExpressionUUID->"d1fa29c3-ffc3-4f6f-a4e4-f8f47fe55de3"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQDQFSByD0AnsILYHGF4Py50D5IlD+DihfCMpfAuUL
QPl7oXweKH83lM8B5a+D8lmg/G1QPgOa/I/9qPZ9gPK3QvkP9qO6DwZmwOTt
Ufkf7FHV/4DSE2D6HSDUFJj7oPwCmPvR+DwOqPYKQPkdsPBBUy8C5TfAwheN
L4FmnhQaXwZuHgCWaysG
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     StyleBox[
     "\"Sampled \[LeftAngleBracket]H\[RightAngleBracket] Value\"", FontSize -> 
      17, StripOnInput -> False], TraditionalForm], 
    FormBox[
     StyleBox[
     "\"Sampled \[LeftAngleBracket]H\[RightAngleBracket] Probability\"", 
      FontSize -> 17, StripOnInput -> False], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox[
    "\"3-Qubit LMG \[LeftAngleBracket]H\[RightAngleBracket] Estimates\"", 
     FontSize -> 25, StripOnInput -> False], TraditionalForm],
  PlotRange->{{-6.5, 7.}, {0, 0.11328125}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.852027725324094*^9, 3.85202773971369*^9}, 
   3.852027790506556*^9, {3.852028123295957*^9, 3.8520281295581617`*^9}, {
   3.852028677126625*^9, 3.8520287192736797`*^9}, 3.8520287497891197`*^9, {
   3.852028820912098*^9, 3.852028889996634*^9}, {3.852029023498476*^9, 
   3.85202903199303*^9}, {3.852029096233757*^9, 3.8520291441199427`*^9}, {
   3.852029188432682*^9, 3.852029203305828*^9}, {3.852029235023405*^9, 
   3.852029242950612*^9}, 3.852029343765148*^9, 3.852029612621873*^9, {
   3.852029695771638*^9, 3.85202971648778*^9}, {3.8520297561534224`*^9, 
   3.852029801818596*^9}, 3.85203046963967*^9},
 CellLabel->
  "Out[510]=",ExpressionUUID->"1a5f1280-ee5d-4a4e-b25c-92fa57e25200"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     LineBox[{{1., 0.0031949763058711058`}, {2., 0.08363880711481307}, {
      2.837217172697653, 0.15}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     StyleBox["\"Qubit Number\"", FontSize -> 17, StripOnInput -> False], 
     TraditionalForm], 
    FormBox[
     StyleBox[
     "\"|Relative Error of \[LeftAngleBracket]H\[RightAngleBracket]|\"", 
      FontSize -> 17, StripOnInput -> False], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox[
    "\"LMG \[LeftAngleBracket]H\[RightAngleBracket] Estimates By Qubit \
Count\"", FontSize -> 25, StripOnInput -> False], TraditionalForm],
  PlotRange->{{0, 3}, {0, 0.15}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.852027725324094*^9, 3.85202773971369*^9}, 
   3.852027790506556*^9, {3.852028123295957*^9, 3.8520281295581617`*^9}, {
   3.852028677126625*^9, 3.8520287192736797`*^9}, 3.8520287497891197`*^9, {
   3.852028820912098*^9, 3.852028889996634*^9}, {3.852029023498476*^9, 
   3.85202903199303*^9}, {3.852029096233757*^9, 3.8520291441199427`*^9}, {
   3.852029188432682*^9, 3.852029203305828*^9}, {3.852029235023405*^9, 
   3.852029242950612*^9}, 3.852029343765148*^9, 3.852029612621873*^9, {
   3.852029695771638*^9, 3.85202971648778*^9}, {3.8520297561534224`*^9, 
   3.852029801818596*^9}, 3.852030469670218*^9},
 CellLabel->
  "Out[511]=",ExpressionUUID->"0a1088fc-08af-4ebb-a826-50954aedab69"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\t\t\t\t", 
  RowBox[{"(*", " ", 
   StyleBox["Library",
    FontSize->72], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "h", ",", "vec", ",", "M", ",", "\[Nu]a", ",", "\[Nu]b", ",", "V", ",", 
     "W", ",", "id", ",", "x", ",", "y", ",", "z", ",", "sig", ",", "na", ",",
      "nb", ",", "nanb", ",", "vad", ",", "vbd", ",", "kp", ",", "ham", ",", 
     "nterms", ",", "alth1", ",", "alth2", ",", "idenc", ",", "z1c", ",", 
     "zMc", ",", "zjc", ",", "zijc", ",", "altn", ",", "xjc", ",", "yjc", ",",
      "yzjc", ",", "xzjc", ",", "exterms", ",", "hamterms", ",", "hmaker", 
     ",", "hamterms2", ",", "hamtermsnoy", ",", "cl1maker", ",", "cl2maker", 
     ",", "cl3maker", ",", "cl4maker", ",", "unit", ",", "diagmat", ",", 
     "cl1diag", ",", "cl2diag", ",", "cl3diag", ",", "cl4diag", ",", "dict1", 
     ",", "dict2", ",", "dict3", ",", "dict4"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "efcl1", ",", "efcl2", ",", "efcl3", ",", "efcl4", ",", "efdic1", ",", 
     "efdic2", ",", "efdic3", ",", "efdic4", ",", "outputeater1", ",", 
     "outputeater2", ",", "outputeater3", ",", "outputeater4"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", "M_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"M", "\[Equal]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["2"]], ",", 
           FractionBox["1", 
            SqrtBox["2"]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["2"]], ",", 
           RowBox[{"-", 
            FractionBox["1", 
             SqrtBox["2"]]}]}], "}"}]}], "}"}], ",", 
       RowBox[{"KroneckerProduct", "@@", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"HadamardMatrix", "[", "2", "]"}], "&"}], ",", "M"}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c2not", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"id", ",", "x", ",", "y", ",", "z"}], "}"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vec", "[", 
     RowBox[{"len_", ",", "entry_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{"0", "&"}], ",", "len"}], "]"}], ",", 
      RowBox[{"entry", "\[Rule]", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kp", "[", "ps__", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "ps", "}"}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"sig", "[", 
        RowBox[{"[", 
         RowBox[{"ps", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{"KroneckerProduct", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"sig", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", "ps", "}"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"{", "ps", "}"}], "]"}]}], "}"}]}], "]"}]}], ")"}]}], 
      "]"}], ")"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Makes", " ", "Kronecker", " ", "Products", " ", 
     RowBox[{"easier", ".", "  ", "Just"}], " ", "input", " ", "some", " ", 
     "numbers", " ", "from", " ", "0", " ", "to", " ", "3", " ", "separated", 
     " ", "by", " ", 
     RowBox[{"commas", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sig", "=", 
     RowBox[{"{", 
      RowBox[{"id", ",", "x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"na", "[", "M_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["\[Nu]a", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"2", "^", "M"}], "]"}], "+", 
         RowBox[{"kp", "@@", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"\[Nu]a", "+", 
         RowBox[{"2", "M"}]}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"2", "^", "M"}], "]"}], "-", 
         RowBox[{"kp", "@@", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "M"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "4"], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Nu]a", "+", 
            RowBox[{"2", "k"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"2", "^", "M"}], "]"}], "-", 
              RowBox[{"kp", "@@", 
               RowBox[{"(", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", "k"}], "]"}]}], ")"}]}]}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"2", "^", "M"}], "]"}], "+", 
              RowBox[{"kp", "@@", 
               RowBox[{"(", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}]}], ")"}]}], 
           ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], ")"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"The", " ", 
     SubscriptBox["n", "a"], " ", 
     RowBox[{"operator", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb", "[", "M_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"\[Nu]b", "+", 
         RowBox[{"2", "M"}]}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"2", "^", "M"}], "]"}], "+", 
         RowBox[{"kp", "@@", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["\[Nu]b", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"2", "^", "M"}], "]"}], "-", 
         RowBox[{"kp", "@@", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "M"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "4"], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Nu]b", "+", 
            RowBox[{"2", "M"}], "-", 
            RowBox[{"2", "k"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"2", "^", "M"}], "]"}], "-", 
              RowBox[{"kp", "@@", 
               RowBox[{"(", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", "k"}], "]"}]}], ")"}]}]}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"2", "^", "M"}], "]"}], "+", 
              RowBox[{"kp", "@@", 
               RowBox[{"(", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}]}], ")"}]}], 
           ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], ")"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"The", " ", 
     SubscriptBox["n", "b"], " ", 
     RowBox[{"operator", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nanb", "[", "M_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"\[Nu]a", 
         RowBox[{"(", 
          RowBox[{"\[Nu]b", "+", 
           RowBox[{"2", "M"}]}], ")"}]}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"2", "^", "M"}], "]"}], "+", 
         RowBox[{"kp", "@@", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Nu]a", "+", 
           RowBox[{"2", "M"}]}], ")"}], "\[Nu]b"}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"2", "^", "M"}], "]"}], "-", 
         RowBox[{"kp", "@@", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "M"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "4"], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Nu]b", "+", 
            RowBox[{"2", "M"}], "-", 
            RowBox[{"2", "k"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"\[Nu]a", "+", 
            RowBox[{"2", "k"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"2", "^", "M"}], "]"}], "-", 
              RowBox[{"kp", "@@", 
               RowBox[{"(", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", "k"}], "]"}]}], ")"}]}]}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"2", "^", "M"}], "]"}], "+", 
              RowBox[{"kp", "@@", 
               RowBox[{"(", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}]}], ")"}]}], 
           ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], ")"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"The", " ", 
     SubscriptBox["n", "a"], 
     SubscriptBox["n", "b"], " ", "operator"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nterms", "[", "M_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"2", "M"}], "+", "\[Nu]b", "-", "\[Nu]a"}], "2"], "+", 
         FractionBox["W", "2"], "+", 
         FractionBox[
          RowBox[{"W", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "M"}], "+", "\[Nu]b"}], ")"}], 
           RowBox[{"(", "\[Nu]a", ")"}]}], 
          RowBox[{
           RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}]]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"2", "^", "M"}], "]"}], "+", 
         RowBox[{"kp", "@@", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Nu]b", "-", 
           RowBox[{"2", "M"}], "-", "\[Nu]a"}], "2"], "+", 
         FractionBox["W", "2"], "+", 
         FractionBox[
          RowBox[{"W", 
           RowBox[{"(", "\[Nu]b", ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Nu]a", "+", 
             RowBox[{"2", "M"}]}], ")"}]}], 
          RowBox[{
           RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}]]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"2", "^", "M"}], "]"}], "-", 
         RowBox[{"kp", "@@", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "M"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "4"], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"2", "M"}], "+", "\[Nu]b", "-", "\[Nu]a", "-", 
              RowBox[{"4", "k"}]}], "2"], "+", 
            FractionBox["W", "2"], "+", 
            FractionBox[
             RowBox[{"W", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "M"}], "+", "\[Nu]b", "-", 
                RowBox[{"2", "k"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"\[Nu]a", "+", 
                RowBox[{"2", "k"}]}], ")"}]}], 
             RowBox[{
              RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}]]}], ")"}], 
          "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"2", "^", "M"}], "]"}], "-", 
             RowBox[{"kp", "@@", 
              RowBox[{"(", 
               RowBox[{"3", "*", 
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "k"}], "]"}]}], ")"}]}]}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"2", "^", "M"}], "]"}], "+", 
             RowBox[{"kp", "@@", 
              RowBox[{"(", 
               RowBox[{"3", "*", 
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", 
                  RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}]}], ")"}]}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], ")"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "outputs", " ", "the", " ", "number", " ", "operator", " ", "terms", " ", 
     "of", " ", "the", " ", "Hamiltonian", " ", "but", " ", "as", " ", "a", 
     " ", "whole", " ", "unit", " ", "with", " ", "only", " ", "one", " ", 
     "set", " ", "of", " ", "Paulis", " ", "to", " ", "multiply", " ", 
     RowBox[{"by", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vad", "[", "M_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Nu]a", "+", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"\[Nu]a", "+", "2"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"\[Nu]b", "+", 
           RowBox[{"2", "M"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"\[Nu]b", "+", 
           RowBox[{"2", "M"}], "-", "1"}], ")"}]}], "]"}], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"kp", "@@", 
         RowBox[{"(", 
          RowBox[{"1", "*", 
           RowBox[{"vec", "[", 
            RowBox[{"M", ",", "1"}], "]"}]}], ")"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"kp", "@@", 
          RowBox[{"(", 
           RowBox[{"2", "*", 
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "1"}], "]"}]}], ")"}]}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"1", "/", "4"}], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Nu]a", "+", 
             RowBox[{"2", "k"}], "+", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Nu]a", "+", 
             RowBox[{"2", "k"}], "+", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Nu]b", "+", 
             RowBox[{"2", "M"}], "-", 
             RowBox[{"2", "k"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Nu]b", "+", 
             RowBox[{"2", "M"}], "-", 
             RowBox[{"2", "k"}], "-", "1"}], ")"}]}], "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"2", "^", "M"}], "]"}], "-", 
            RowBox[{"kp", "@@", 
             RowBox[{"(", 
              RowBox[{"3", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "k"}], "]"}]}], ")"}]}]}], ")"}], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kp", "@@", 
             RowBox[{"(", 
              RowBox[{"1", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", 
                 RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"kp", "@@", 
              RowBox[{"(", 
               RowBox[{"2", "*", 
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", 
                  RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}]}]}], ")"}]}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}]}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"the", " ", 
     RowBox[{"a", "^", "dag"}], " ", 
     RowBox[{"a", "^", "dag"}], " ", "b", " ", "b", " ", "operator"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vbd", "[", "M_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Nu]a", "+", 
             RowBox[{"2", "M"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Nu]a", "+", 
             RowBox[{"2", "M"}], "-", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Nu]b", "+", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Nu]b", "+", "1"}], ")"}]}], "]"}], "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kp", "@@", 
           RowBox[{"(", 
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "M"}], "]"}], ")"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"kp", "@@", 
            RowBox[{"(", 
             RowBox[{"2", "*", 
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", "M"}], "]"}]}], ")"}]}]}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "4"], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Nu]a", "+", 
               RowBox[{"2", "k"}], "-", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"\[Nu]a", "+", 
               RowBox[{"2", "k"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"\[Nu]b", "+", 
               RowBox[{"2", "M"}], "+", "2", "-", 
               RowBox[{"2", "k"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"\[Nu]b", "+", 
               RowBox[{"2", "M"}], "+", "1", "-", 
               RowBox[{"2", "k"}]}], ")"}]}], "]"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kp", "@@", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "k"}], "]"}]}], "+", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"kp", "@@", 
                RowBox[{"(", 
                 RowBox[{"2", 
                  RowBox[{"vec", "[", 
                   RowBox[{"M", ",", "k"}], "]"}]}], ")"}]}]}]}], ")"}], ".", 
            
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"2", "^", "M"}], "]"}], "+", " ", 
              RowBox[{"kp", "@@", 
               RowBox[{"(", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}]}], ")"}]}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], ")"}]}], ";"}], 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{"the", " ", 
     RowBox[{"b", "^", "dag"}], " ", 
     RowBox[{"b", "^", "dag"}], " ", "a", " ", "a", " ", "operator"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"idenc", "[", "M_", "]"}], ":=", 
    RowBox[{"(", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"W", " ", 
        RowBox[{"M", "^", "3"}]}], 
       RowBox[{"6", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"M", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"\[Nu]b", "-", "\[Nu]a", "+", 
          RowBox[{"W", 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]}], ")"}]}], 
       RowBox[{"4", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"M", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"21", 
           RowBox[{"(", 
            RowBox[{"\[Nu]b", "-", "\[Nu]a"}], ")"}]}], "+", 
          RowBox[{"W", 
           RowBox[{"(", 
            RowBox[{"14", "+", 
             RowBox[{"21", 
              RowBox[{"(", 
               RowBox[{"\[Nu]a", "+", "\[Nu]b"}], ")"}]}], "+", 
             RowBox[{"6", "\[Nu]a", " ", "\[Nu]b"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"24", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"3", 
        RowBox[{"(", 
         RowBox[{"\[Nu]b", "-", "\[Nu]a", "+", 
          RowBox[{"W", 
           RowBox[{"(", 
            RowBox[{"\[Nu]a", "+", "\[Nu]b", "+", 
             RowBox[{"2", "\[Nu]a", " ", "\[Nu]b"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"8", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]]}], 
     ")"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "coefficient", " ", "for", " ", "the", " ", "Identity", " ", 
     "operator", " ", "in", " ", "the", " ", "encoded", " ", 
     RowBox[{"Hamiltonian", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"z1c", "[", "M_", "]"}], ":=", 
     FractionBox[
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["M", "2"]}], "+", 
       RowBox[{"3", " ", "\[Nu]a"}], "+", 
       RowBox[{"5", " ", "\[Nu]b"}], "+", 
       RowBox[{"M", " ", 
        RowBox[{"(", 
         RowBox[{"8", "-", 
          RowBox[{"6", " ", "W"}], "+", 
          RowBox[{"4", " ", "W", " ", "\[Nu]a"}], "+", 
          RowBox[{"4", " ", "\[Nu]b"}]}], ")"}]}], "+", 
       RowBox[{"W", " ", 
        RowBox[{"(", 
         RowBox[{"8", "+", 
          RowBox[{"5", " ", "\[Nu]a"}], "-", 
          RowBox[{"3", " ", "\[Nu]b"}], "+", 
          RowBox[{"2", " ", "\[Nu]a", " ", "\[Nu]b"}]}], ")"}]}]}], 
      RowBox[{"8", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]]}], 
    ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "coefficient", " ", "for", " ", "the", " ", "Z_", "1", " ", 
     "operator", " ", "in", " ", "the", " ", "encoded", " ", 
     RowBox[{"Hamiltonian", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zMc", "[", "M_", "]"}], ":=", 
     FractionBox[
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["M", "2"]}], "+", 
       RowBox[{"5", " ", "\[Nu]a"}], "+", 
       RowBox[{"3", " ", "\[Nu]b"}], "+", 
       RowBox[{"M", " ", 
        RowBox[{"(", 
         RowBox[{"8", "+", 
          RowBox[{"6", " ", "W"}], "+", 
          RowBox[{"4", " ", "\[Nu]a"}], "-", 
          RowBox[{"4", " ", "W", " ", "\[Nu]b"}]}], ")"}]}], "-", 
       RowBox[{"W", " ", 
        RowBox[{"(", 
         RowBox[{"8", "-", 
          RowBox[{"3", " ", "\[Nu]a"}], "+", 
          RowBox[{"5", " ", "\[Nu]b"}], "+", 
          RowBox[{"2", " ", "\[Nu]a", " ", "\[Nu]b"}]}], ")"}]}]}], 
      RowBox[{"8", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "coefficient", " ", "for", " ", "the", " ", "Z_M", " ", 
     "operator", " ", "in", " ", "the", " ", "encoded", " ", 
     RowBox[{"Hamiltonian", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zjc", "[", 
      RowBox[{"M_", ",", "k_"}], "]"}], ":=", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "M", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "W"}], ")"}]}], "+", "\[Nu]a", "+", 
         RowBox[{"W", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"4", " ", "k"}], "+", "\[Nu]a", "-", "\[Nu]b"}], ")"}]}], 
         "+", "\[Nu]b"}], ")"}]}], 
      RowBox[{"4", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "The", " ", "coefficient", " ", "for", " ", "the", " ", "Z_j", " ", 
      "operator", " ", "in", " ", "the", " ", "encoded", " ", "Hamiltonian", 
      " ", "when", " ", "2"}], "\[LessEqual]", " ", "j", " ", "\[LessEqual]", 
     " ", 
     RowBox[{"M", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zijc", "[", 
      RowBox[{"M_", ",", "k_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", "8"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "k"}], "-", 
        RowBox[{"2", " ", "M"}], "-", "W", "+", "\[Nu]a", "-", "\[Nu]b", "-", 
        
        FractionBox[
         RowBox[{"2", " ", "W", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "k"}], "+", "\[Nu]a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "k"}], "+", 
            RowBox[{"2", " ", "M"}], "+", "\[Nu]b"}], ")"}]}], 
         RowBox[{
          RowBox[{"2", " ", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}]]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "The", " ", "coefficient", " ", "for", " ", "the", " ", "Z_jZ", "_", 
      RowBox[{"{", 
       RowBox[{"j", "+", "1"}], "}"}], " ", "operator", " ", "in", " ", "the",
       " ", "encoded", " ", "Hamiltonian", " ", "when", " ", "2"}], 
     "\[LessEqual]", " ", "j", " ", "\[LessEqual]", " ", 
     RowBox[{"M", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xjc", "[", 
      RowBox[{"M_", ",", "k_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["V", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]], "*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"k", ",", "M"}], "]"}], "+", 
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"k", ",", "1"}], "]"}]}], ")"}], "/", "2"}]}], "2"], 
        "*", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Nu]a", "+", 
            RowBox[{"2", "k"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"\[Nu]a", "+", 
            RowBox[{"2", "k"}], "-", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "M"}], "+", "\[Nu]b", "-", 
            RowBox[{"2", "k"}], "+", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "M"}], "+", "\[Nu]b", "-", 
            RowBox[{"2", "k"}], "+", "2"}], ")"}]}]]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "Coefficient", " ", "for", " ", "the", " ", "X_j", " ", 
     "operators", " ", "in", " ", "the", " ", "encoded", " ", 
     RowBox[{"Hamiltonian", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xzjc", "[", 
      RowBox[{"M_", ",", "k_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["V", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]], "*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "4"], 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Nu]a", "+", 
            RowBox[{"2", "k"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"\[Nu]a", "+", 
            RowBox[{"2", "k"}], "-", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "M"}], "+", "\[Nu]b", "-", 
            RowBox[{"2", "k"}], "+", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "M"}], "+", "\[Nu]b", "-", 
            RowBox[{"2", "k"}], "+", "2"}], ")"}]}]]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"The", " ", "Coefficient", " ", "for", " ", "the"}], " ", 
     "\[PlusMinus]", 
     RowBox[{"X_kZ", "_", 
      RowBox[{"{", 
       RowBox[{"k", "\[PlusMinus]", "1"}], "}"}], " ", "operators", " ", "in",
       " ", "the", " ", "encoded", " ", 
      RowBox[{"Hamiltonian", ".", " ", "Remember"}], " ", "that", " ", 
      RowBox[{"it", "'"}], "s", " ", "negative", " ", "when", " ", "Z", " ", 
      "goes", " ", "before", " ", 
      RowBox[{"X", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yjc", "[", 
      RowBox[{"M_", ",", "k_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["V", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]], "*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"\[ImaginaryI]", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", 
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"k", ",", "1"}], "]"}]}]}], ")"}]}], "4"], 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Nu]a", "+", 
            RowBox[{"2", "k"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"\[Nu]a", "+", 
            RowBox[{"2", "k"}], "-", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "M"}], "+", "\[Nu]b", "-", 
            RowBox[{"2", "k"}], "+", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "M"}], "+", "\[Nu]b", "-", 
            RowBox[{"2", "k"}], "+", "2"}], ")"}]}]]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"M", ",", "1"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "The", " ", "Coefficient", " ", "for", " ", "the", " ", "Y_k", " ", 
       "operators", " ", "in", " ", "the", " ", "encoded", " ", 
       RowBox[{"Hamiltonian", ".", " ", "Keep"}], " ", "in", " ", "mind", " ",
        "that", " ", "the", " ", "pure"}], "-", 
      RowBox[{
      "Y", " ", "terms", " ", "that", " ", "appear", " ", "go", " ", "with", 
       " ", "k"}]}], "=", 
     RowBox[{
      RowBox[{"1", " ", "or", " ", "k"}], "=", 
      RowBox[{"M", " ", 
       RowBox[{"only", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yzjc", "[", 
      RowBox[{"M_", ",", "k_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["V", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]], "*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["\[ImaginaryI]", "4"], 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Nu]a", "+", 
            RowBox[{"2", "k"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"\[Nu]a", "+", 
            RowBox[{"2", "k"}], "-", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "M"}], "+", "\[Nu]b", "-", 
            RowBox[{"2", "k"}], "+", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "M"}], "+", "\[Nu]b", "-", 
            RowBox[{"2", "k"}], "+", "2"}], ")"}]}]]}], ")"}]}]}], " ", ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "The", " ", "Coefficient", " ", "for", " ", "the", " ", "Y_kZ", "_", 
       RowBox[{"{", 
        RowBox[{"k", "\[PlusMinus]", "1"}], "}"}], " ", "operators", " ", 
       "in", " ", "the", " ", "encoded", " ", 
       RowBox[{"Hamiltonian", ".", " ", "Keep"}], " ", "in", " ", "mind", " ",
        "that", " ", "the", " ", "pure"}], "-", 
      RowBox[{
      "Y", " ", "terms", " ", "that", " ", "appear", " ", "go", " ", "with", 
       " ", "k"}]}], "=", 
     RowBox[{
      RowBox[{"1", " ", "or", " ", "k"}], "=", 
      RowBox[{"M", " ", 
       RowBox[{"only", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"exterms", "[", "M_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xjc", "[", 
           RowBox[{"M", ",", "k"}], "]"}], "*", 
          RowBox[{"kp", "@@", 
           RowBox[{"vec", "[", 
            RowBox[{"M", ",", "k"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "M"}], "}"}]}], "]"}], "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"yjc", "[", 
           RowBox[{"M", ",", "k"}], "]"}], "*", 
          RowBox[{"kp", "@@", 
           RowBox[{"(", 
            RowBox[{"2", 
             RowBox[{"vec", "[", 
              RowBox[{"M", ",", "k"}], "]"}]}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "M"}], "}"}]}], "}"}]}], "]"}], "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"yzjc", "[", 
           RowBox[{"M", ",", "k"}], "]"}], "*", 
          RowBox[{"kp", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "+", 
             RowBox[{"3", 
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", 
                RowBox[{"k", "+", "1"}]}], "]"}]}]}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"yzjc", "[", 
           RowBox[{"M", ",", "k"}], "]"}], "*", 
          RowBox[{"kp", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "+", 
             RowBox[{"3", 
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", 
                RowBox[{"k", "-", "1"}]}], "]"}]}]}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2", ",", "M"}], "}"}]}], "]"}], "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xzjc", "[", 
           RowBox[{"M", ",", "k"}], "]"}], "*", 
          RowBox[{"kp", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"vec", "[", 
              RowBox[{"M", ",", "k"}], "]"}], "+", 
             RowBox[{"3", 
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", 
                RowBox[{"k", "+", "1"}]}], "]"}]}]}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], "-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xzjc", "[", 
           RowBox[{"M", ",", "k"}], "]"}], "*", 
          RowBox[{"kp", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"vec", "[", 
              RowBox[{"M", ",", "k"}], "]"}], "+", 
             RowBox[{"3", 
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", 
                RowBox[{"k", "-", "1"}]}], "]"}]}]}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2", ",", "M"}], "}"}]}], "]"}]}], ")"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"altn", "[", "M_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"2", "^", "M"}], "]"}], "*", 
        RowBox[{"idenc", "[", "M", "]"}]}], "+", 
       RowBox[{
        RowBox[{"z1c", "[", "M", "]"}], "*", 
        RowBox[{"kp", "@@", 
         RowBox[{"(", 
          RowBox[{"3", "*", 
           RowBox[{"vec", "[", 
            RowBox[{"M", ",", "1"}], "]"}]}], ")"}]}]}], "+", 
       RowBox[{
        RowBox[{"zMc", "[", "M", "]"}], "*", 
        RowBox[{"kp", "@@", 
         RowBox[{"(", 
          RowBox[{"3", "*", 
           RowBox[{"vec", "[", 
            RowBox[{"M", ",", "M"}], "]"}]}], ")"}]}]}], "+", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"zjc", "[", 
           RowBox[{"M", ",", "k"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"kp", "@@", 
            RowBox[{"(", 
             RowBox[{"3", "*", 
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], ")"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2", ",", 
           RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], "+", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"zijc", "[", 
           RowBox[{"M", ",", "k"}], "]"}], "*", 
          RowBox[{"kp", "@@", 
           RowBox[{"(", 
            RowBox[{"3", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "k"}], "]"}], "+", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", 
                 RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}], ")"}]}]}], ",", 
         
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"M", ",", "1"}], "]"}], 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Nu]a", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", "W"}], ")"}], " ", "\[Nu]a"}], "-", "\[Nu]b", 
           "+", 
           RowBox[{"W", " ", "\[Nu]b"}]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]], ")"}], 
        RowBox[{"kp", "@@", 
         RowBox[{"(", 
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"vec", "[", 
              RowBox[{"M", ",", "1"}], "]"}], "+", 
             RowBox[{"vec", "[", 
              RowBox[{"M", ",", "2"}], "]"}]}], ")"}]}], ")"}]}]}]}], ")"}]}],
     ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "The", " ", "number", " ", "operators", " ", "with", " ", "generated", 
      " ", "coefficients", " ", "for", " ", "their", " ", "pauli", " ", 
      RowBox[{"terms", ".", " ", "Extra"}], " ", "term", " ", "is", " ", 
      "for", " ", "the", " ", "trivial", " ", "M"}], "=", 
     RowBox[{"1", " ", 
      RowBox[{"case", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ham", "[", "M_", "]"}], ":=", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"nb", "[", "M", "]"}], "-", 
       RowBox[{"na", "[", "M", "]"}]}], "2"], "+", 
     FractionBox[
      RowBox[{"V", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vad", "[", "M", "]"}], "+", 
         RowBox[{"vbd", "[", "M", "]"}]}], ")"}]}], 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]], "+", 
     RowBox[{
      FractionBox["W", 
       RowBox[{
        RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}]], 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"na", "[", "M", "]"}], "+", 
          RowBox[{"nb", "[", "M", "]"}]}], "2"], "+", 
        RowBox[{"nanb", "[", "M", "]"}]}], ")"}]}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Seems", " ", "to", " ", "have", " ", "a", " ", "decomposition", " ", 
      "made", " ", "up", " ", "of", " ", "7", "M"}], "-", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["\[Delta]", 
         RowBox[{"1", ",", "M"}]]}], ")"}], " ", 
      RowBox[{"terms", ".", " ", "Also"}], " ", "seems", " ", "to", " ", "be",
       " ", "correct", " ", "when", " ", "compared", " ", "to", " ", "other", 
      " ", "versions", " ", 
      RowBox[{"I", "'"}], "ve", " ", 
      RowBox[{"done", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alth1", "[", "M_", "]"}], ":=", 
    RowBox[{
     RowBox[{"altn", "[", "M", "]"}], "+", 
     FractionBox[
      RowBox[{"V", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vad", "[", "M", "]"}], "+", 
         RowBox[{"vbd", "[", "M", "]"}]}], ")"}]}], 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "M"}], "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alth2", "[", "M_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"altn", "[", "M", "]"}], "+", 
     RowBox[{"exterms", "[", "M", "]"}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "LMG", " ", "Hamiltonian", " ", "except", " ", "the", " ", 
     "coefficients", " ", "and", " ", "Pauli", " ", "terms", " ", "are", " ", 
     "more", " ", "efficiently", " ", 
     RowBox[{"generated", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hamterms", "[", "M_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"main", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", "k"}], "]"}], ",", 
              RowBox[{"xjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "M"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "k"}], "]"}]}], ",", 
              RowBox[{"yjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "M"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", "k"}], "]"}]}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{"yzjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", "k"}], "]"}]}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "-", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{"yzjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2", ",", "M"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "k"}], "]"}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{"xzjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "k"}], "]"}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "-", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{"-", 
               RowBox[{"xzjc", "[", 
                RowBox[{"M", ",", "k"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2", ",", "M"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Array", "[", 
               RowBox[{
                RowBox[{"0", "&"}], ",", "M"}], "]"}], ",", 
              RowBox[{"idenc", "[", "M", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "1"}], "]"}]}], ",", 
              RowBox[{"z1c", "[", "M", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "M"}], "]"}]}], ",", 
              RowBox[{"zMc", "[", "M", "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "k"}], "]"}]}], ",", 
              RowBox[{"zjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", "k"}], "]"}], "+", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}], ",", 
              RowBox[{"zijc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"M", "\[Equal]", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "\[Nu]a"}], "+", 
               RowBox[{"3", " ", "\[Nu]b"}], "+", 
               RowBox[{"W", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  RowBox[{"3", " ", "\[Nu]b"}], "+", 
                  RowBox[{"\[Nu]a", " ", 
                   RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{"2", " ", "\[Nu]b"}]}], ")"}]}]}], ")"}]}]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             FractionBox[
              RowBox[{"V", " ", 
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "\[Nu]a"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", "\[Nu]a"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "\[Nu]b"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", "\[Nu]b"}], ")"}]}]]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "3", "}"}], ",", 
             FractionBox[
              RowBox[{"2", "+", "\[Nu]a", "+", 
               RowBox[{"W", " ", "\[Nu]a"}], "+", "\[Nu]b", "-", 
               RowBox[{"W", " ", "\[Nu]b"}]}], 
              RowBox[{"2", "+", "\[Nu]a", "+", "\[Nu]b"}]]}], "}"}]}], "}"}], 
         ",", "main"}], "]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Efficiently", " ", "generates", " ", "a", " ", "list", " ", "of", " ", 
      "Pauli", " ", "strings", " ", "and", " ", "their", " ", 
      RowBox[{"coefficients", ".", " ", "\"\<If[]\>\""}], " ", "statement", 
      " ", "is", " ", "to", " ", "avoid", " ", "some", " ", "redundancy", " ",
       "issues", " ", "at", " ", "M"}], "=", "1."}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hamtermsnoy", "[", "M_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"main", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", "k"}], "]"}], ",", 
              RowBox[{"xjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "M"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "k"}], "]"}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{"xzjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "k"}], "]"}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "-", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{"-", 
               RowBox[{"xzjc", "[", 
                RowBox[{"M", ",", "k"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2", ",", "M"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Array", "[", 
               RowBox[{
                RowBox[{"0", "&"}], ",", "M"}], "]"}], ",", 
              RowBox[{"idenc", "[", "M", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "1"}], "]"}]}], ",", 
              RowBox[{"z1c", "[", "M", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "M"}], "]"}]}], ",", 
              RowBox[{"zMc", "[", "M", "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "k"}], "]"}]}], ",", 
              RowBox[{"zjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", "k"}], "]"}], "+", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}], ",", 
              RowBox[{"zijc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"M", "\[Equal]", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "\[Nu]a"}], "+", 
               RowBox[{"3", " ", "\[Nu]b"}], "+", 
               RowBox[{"W", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  RowBox[{"3", " ", "\[Nu]b"}], "+", 
                  RowBox[{"\[Nu]a", " ", 
                   RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{"2", " ", "\[Nu]b"}]}], ")"}]}]}], ")"}]}]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             FractionBox[
              RowBox[{"V", " ", 
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "\[Nu]a"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", "\[Nu]a"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "\[Nu]b"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", "\[Nu]b"}], ")"}]}]]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "3", "}"}], ",", 
             FractionBox[
              RowBox[{"2", "+", "\[Nu]a", "+", 
               RowBox[{"W", " ", "\[Nu]a"}], "+", "\[Nu]b", "-", 
               RowBox[{"W", " ", "\[Nu]b"}]}], 
              RowBox[{"2", "+", "\[Nu]a", "+", "\[Nu]b"}]]}], "}"}]}], "}"}], 
         ",", "main"}], "]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Efficiently", " ", "generates", " ", "a", " ", "list", " ", "of", " ", 
      "Pauli", " ", "strings", " ", "and", " ", "their", " ", "coefficients", 
      " ", "WITHOUT", " ", "including", " ", "the", " ", "Pauli", " ", "Y", 
      " ", 
      RowBox[{"things", ".", " ", "These"}], " ", "have", " ", "expectation", 
      " ", "values", " ", "of", " ", "0", " ", 
      RowBox[{"anyways", "!"}], " ", "The", " ", "\"\<If[]\>\"", " ", 
      "statement", " ", "is", " ", "to", " ", "avoid", " ", "some", " ", 
      "redundancy", " ", "issues", " ", "at", " ", "M"}], "=", "1."}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hamterms2", "[", "M_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"main", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vec", "[", 
               RowBox[{"M", ",", "j"}], "]"}], ",", 
              RowBox[{
               RowBox[{"xjc", "[", 
                RowBox[{"M", ",", "j"}], "]"}], 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "[", "j", "]"}], "]"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"Cos", "[", 
                  FractionBox[
                   RowBox[{"\[Theta]", "[", 
                    RowBox[{"j", "+", "1"}], "]"}], "2"], "]"}], ")"}], 
                RowBox[{"1", "-", 
                 RowBox[{"KroneckerDelta", "[", 
                  RowBox[{"j", ",", "M"}], "]"}]}]], 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   FractionBox[
                    RowBox[{"\[Theta]", "[", "k", "]"}], "2"], "]"}], "^", 
                  "2"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", 
                   RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "M"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "j"}], "]"}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"j", "+", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{
               RowBox[{"xzjc", "[", 
                RowBox[{"M", ",", "j"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"KroneckerDelta", "[", 
                  RowBox[{"j", ",", "M"}], "]"}]}], ")"}], 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "[", "j", "]"}], "]"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"Cos", "[", 
                  FractionBox[
                   RowBox[{"\[Theta]", "[", 
                    RowBox[{"j", "+", "1"}], "]"}], "2"], "]"}], ")"}], 
                RowBox[{"1", "-", 
                 RowBox[{"KroneckerDelta", "[", 
                  RowBox[{"j", ",", "M"}], "]"}]}]], 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   FractionBox[
                    RowBox[{"\[Theta]", "[", "k", "]"}], "2"], "]"}], "^", 
                  "2"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", 
                   RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "j"}], "]"}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"j", "-", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"xzjc", "[", 
                 RowBox[{"M", ",", "j"}], "]"}]}], "*", 
               RowBox[{"-", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]", "[", "j", "]"}], "]"}]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"Cos", "[", 
                  FractionBox[
                   RowBox[{"\[Theta]", "[", 
                    RowBox[{"j", "+", "1"}], "]"}], "2"], "]"}], ")"}], 
                RowBox[{"1", "-", 
                 RowBox[{"KroneckerDelta", "[", 
                  RowBox[{"j", ",", "M"}], "]"}]}]], 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   FractionBox[
                    RowBox[{"\[Theta]", "[", "k", "]"}], "2"], "]"}], "^", 
                  "2"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", 
                   RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "M"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Array", "[", 
               RowBox[{
                RowBox[{"0", "&"}], ",", "M"}], "]"}], ",", 
              RowBox[{"idenc", "[", "M", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "1"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"z1c", "[", "M", "]"}], "*", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"ell", "+", "1"}], "]"}], "2"], "]"}], ")"}], 
                   RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"ell", ",", "M"}], "]"}]}], ")"}]}]], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"1", "-", "ell"}], "]"}], "-", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"1", ",", "ell"}], "]"}]}], ")"}], 
                  RowBox[{"Product", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    FractionBox[
                    RowBox[{"\[Theta]", "[", "k", "]"}], "2"], "]"}], "^", 
                    "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "ell"}], "}"}]}], "]"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"ell", ",", "0", ",", "M"}], "}"}]}], "]"}]}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "M"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"zMc", "[", "M", "]"}], "*", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"ell", "+", "1"}], "]"}], "2"], "]"}], ")"}], 
                   RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"ell", ",", "M"}], "]"}]}], ")"}]}]], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"M", "-", "ell"}], "]"}], "-", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"M", ",", "ell"}], "]"}]}], ")"}], 
                  RowBox[{"Product", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    FractionBox[
                    RowBox[{"\[Theta]", "[", "k", "]"}], "2"], "]"}], "^", 
                    "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "ell"}], "}"}]}], "]"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"ell", ",", "0", ",", "M"}], "}"}]}], "]"}]}]}], 
             "}"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "j"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"zjc", "[", 
                RowBox[{"M", ",", "j"}], "]"}], "*", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"ell", "+", "1"}], "]"}], "2"], "]"}], ")"}], 
                   RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"ell", ",", "M"}], "]"}]}], ")"}]}]], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"j", "-", "ell"}], "]"}], "-", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"j", ",", "ell"}], "]"}]}], ")"}], 
                  RowBox[{"Product", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    FractionBox[
                    RowBox[{"\[Theta]", "[", "k", "]"}], "2"], "]"}], "^", 
                    "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "ell"}], "}"}]}], "]"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"ell", ",", "0", ",", "M"}], "}"}]}], "]"}]}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", "j"}], "]"}], "+", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"j", "+", "1"}]}], "]"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"zijc", "[", 
                RowBox[{"M", ",", "j"}], "]"}], "*", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"ell", "+", "1"}], "]"}], "2"], "]"}], ")"}], 
                   RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"ell", ",", "M"}], "]"}]}], ")"}]}]], 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"2", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"j", ",", "ell"}], "]"}]}]}], ")"}], 
                  RowBox[{"Product", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    FractionBox[
                    RowBox[{"\[Theta]", "[", "k", "]"}], "2"], "]"}], "^", 
                    "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "ell"}], "}"}]}], "]"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"ell", ",", "0", ",", "M"}], "}"}]}], "]"}]}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"M", "\[Equal]", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "\[Nu]a"}], "+", 
               RowBox[{"3", " ", "\[Nu]b"}], "+", 
               RowBox[{"W", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  RowBox[{"3", " ", "\[Nu]b"}], "+", 
                  RowBox[{"\[Nu]a", " ", 
                   RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{"2", " ", "\[Nu]b"}]}], ")"}]}]}], ")"}]}]}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"V", " ", 
                SqrtBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Nu]a"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "+", "\[Nu]a"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Nu]b"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "+", "\[Nu]b"}], ")"}]}]]}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "\[Nu]a", "+", "\[Nu]b"}], ")"}]}]], 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", "1", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "3", "}"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"2", "+", "\[Nu]a", "+", 
                RowBox[{"W", " ", "\[Nu]a"}], "+", "\[Nu]b", "-", 
                RowBox[{"W", " ", "\[Nu]b"}]}], 
               RowBox[{"2", "+", "\[Nu]a", "+", "\[Nu]b"}]], 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "[", "1", "]"}], "]"}]}]}], "}"}]}], "}"}],
          ",", "main"}], "]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Efficiently", " ", "generates", " ", "a", " ", "list", " ", "of", " ", 
      "Pauli", " ", "strings", " ", "of", " ", "the", " ", "LMG", " ", 
      "Hamiltonian", " ", 
      RowBox[{"(", 
       RowBox[{"in", " ", "efficient", " ", "unary", " ", "encoding"}], ")"}],
       " ", "and", " ", "their", " ", "expectation", " ", "values", " ", 
      "for", " ", "the", " ", "unary", " ", "EGO", " ", 
      RowBox[{"circuit", ".", " ", "\"\<If[]\>\""}], " ", "statement", " ", 
      "is", " ", "to", " ", "avoid", " ", "some", " ", "redundancy", " ", 
      "issues", " ", "at", " ", "M"}], "=", "1."}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hmaker", "[", "M_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"temp1", "=", 
       RowBox[{"hamterms", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kp", "@@", 
           RowBox[{"temp1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"temp1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "temp1", "]"}]}], "}"}]}], "]"}]}], ")"}]}], 
   "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"Reads", " ", "the", " ", "output", " ", "of", " ", 
     RowBox[{"hamterms", "[", "]"}], " ", "and", " ", "outputs", " ", "the", 
     " ", 
     RowBox[{"hamiltonian", ".", " ", "Seems"}], " ", "to", " ", "work", " ", 
     "for", " ", "all", " ", "cases", " ", 
     RowBox[{"I", "'"}], "ve", " ", 
     RowBox[{"checked", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hmakernoy", "[", "M_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"temp1", "=", 
       RowBox[{"hamtermsnoy", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kp", "@@", 
           RowBox[{"temp1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"temp1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "temp1", "]"}]}], "}"}]}], "]"}]}], ")"}]}], 
   "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"Reads", " ", "the", " ", "output", " ", "of", " ", 
     RowBox[{"hamtermsnoy", "[", "]"}], " ", "and", " ", "outputs", " ", 
     "the", " ", 
     RowBox[{"hamiltonian", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cl1maker", "[", "M_", "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Array", "[", 
               RowBox[{
                RowBox[{"0", "&"}], ",", "M"}], "]"}], ",", 
              RowBox[{"idenc", "[", "M", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "1"}], "]"}]}], ",", 
              RowBox[{"z1c", "[", "M", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "M"}], "]"}]}], ",", 
              RowBox[{"zMc", "[", "M", "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"vec", "[", 
                RowBox[{"M", ",", "k"}], "]"}]}], ",", 
              RowBox[{"zjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", "k"}], "]"}], "+", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}], ")"}]}], ",", 
              RowBox[{"zijc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"kp", "@@", 
            RowBox[{"temp1", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"temp1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "temp1", "]"}]}], "}"}]}], "]"}]}], ")"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Outputs", " ", "the", " ", "sum", " ", "of", " ", "ONLY", " ", "the", 
      " ", "Identity"}], ",", " ", 
     RowBox[{
     "Z", " ", "and", " ", "ZZ", " ", "terms", " ", "of", " ", "the", " ", 
      "Hamiltonian", " ", "as", " ", "a", " ", 
      RowBox[{"matrix", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cl2maker", "[", "M_", "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "k"}], "]"}], ",", 
            RowBox[{"xjc", "[", 
             RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"kp", "@@", 
            RowBox[{"temp1", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"temp1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "temp1", "]"}]}], "}"}]}], "]"}]}], ")"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Outputs", " ", "the", " ", "sum", " ", "of", " ", "ONLY", " ", "the", 
     " ", "X", " ", "terms", " ", "of", " ", "the", " ", "Hamiltonian", " ", 
     "as", " ", "a", " ", 
     RowBox[{"matrix", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cl3maker", "[", "M_", "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "k"}], "]"}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{"xzjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"M", "-", "1"}], ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "k"}], "]"}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "-", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{"-", 
               RowBox[{"xzjc", "[", 
                RowBox[{"M", ",", "k"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2", ",", "M", ",", "2"}], "}"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"kp", "@@", 
            RowBox[{"temp1", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"temp1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "temp1", "]"}]}], "}"}]}], "]"}]}], ")"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Outputs", " ", "the", " ", "sum", " ", "of", " ", "ONLY", " ", "the", 
     " ", "X_j", " ", "Z_", 
     RowBox[{"{", 
      RowBox[{"j", "+", "1"}], "}"}], " ", "and", " ", "Z_j", " ", "X_", 
     RowBox[{"{", 
      RowBox[{"j", "+", "1"}], "}"}], " ", 
     RowBox[{"(", 
      RowBox[{"j", " ", "is", " ", "odd"}], ")"}], " ", "terms", " ", "of", 
     " ", "the", " ", "Hamiltonian", " ", "as", " ", "a", " ", 
     RowBox[{"matrix", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cl2maker", "[", "M_", "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"vec", "[", 
             RowBox[{"M", ",", "k"}], "]"}], ",", 
            RowBox[{"xjc", "[", 
             RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"kp", "@@", 
            RowBox[{"temp1", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"temp1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "temp1", "]"}]}], "}"}]}], "]"}]}], ")"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cl4maker", "[", "M_", "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "k"}], "]"}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "+", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{"xzjc", "[", 
               RowBox[{"M", ",", "k"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2", ",", 
              RowBox[{"M", "-", "1"}], ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"M", ",", "k"}], "]"}], "+", 
                RowBox[{"3", 
                 RowBox[{"vec", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"k", "-", "1"}]}], "]"}]}]}], ")"}], ",", 
              RowBox[{"-", 
               RowBox[{"xzjc", "[", 
                RowBox[{"M", ",", "k"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "3", ",", "M", ",", "2"}], "}"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"kp", "@@", 
            RowBox[{"temp1", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"temp1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "temp1", "]"}]}], "}"}]}], "]"}]}], ")"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Outputs", " ", "the", " ", "sum", " ", "of", " ", "ONLY", " ", "the", 
     " ", "X_j", " ", "Z_", 
     RowBox[{"{", 
      RowBox[{"j", "+", "1"}], "}"}], " ", "and", " ", "Z_j", " ", "X_", 
     RowBox[{"{", 
      RowBox[{"j", "+", "1"}], "}"}], " ", 
     RowBox[{"(", 
      RowBox[{"j", " ", "is", " ", "even"}], ")"}], " ", "terms", " ", "of", 
     " ", "the", " ", "Hamiltonian", " ", "as", " ", "a", " ", 
     RowBox[{"matrix", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"unit", "=", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
        RowBox[{"HadamardMatrix", "[", "2", "]"}]}], "]"}], ".", "c2not", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"HadamardMatrix", "[", "2", "]"}], ",", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diagmat", "[", 
      RowBox[{"M_", ",", "parity_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"parity", "\[Equal]", "1"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigl", "=", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"unit", "&"}], ",", 
            RowBox[{"Floor", "[", 
             FractionBox["M", "2"], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bigl", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OddQ", "[", "M", "]"}], "\[Equal]", "True"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"bigl", ",", "id"}], "]"}], ",", "bigl"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"M", "\[Equal]", "1"}], ",", 
           RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
           RowBox[{"M", "\[Equal]", "2"}], ",", "unit", ",", 
           RowBox[{"M", "\[Equal]", "3"}], ",", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"unit", ",", "id"}], "]"}], ",", 
           RowBox[{"M", "\[GreaterEqual]", "4"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"KroneckerProduct", "@@", "bigl"}]}], "]"}]}], ")"}], ",", 
       
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigl", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "id", "}"}], ",", 
            RowBox[{"Array", "[", 
             RowBox[{
              RowBox[{"unit", "&"}], ",", 
              RowBox[{"Floor", "[", 
               FractionBox[
                RowBox[{"M", "-", "1"}], "2"], "]"}]}], "]"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"bigl", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OddQ", "[", "M", "]"}], "\[Equal]", "False"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"bigl", ",", "id"}], "]"}], ",", "bigl"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"M", "\[Equal]", "1"}], ",", 
           RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
           RowBox[{"M", "\[Equal]", "2"}], ",", 
           RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", 
           RowBox[{"M", "\[Equal]", "3"}], ",", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"id", ",", "unit"}], "]"}], ",", 
           RowBox[{"M", "\[GreaterEqual]", "4"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"KroneckerProduct", "@@", "bigl"}]}], "]"}]}], 
        "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "diagonalization", " ", "matrix", " ", "given", " ", "in", 
     " ", "my", " ", "notebook", " ", "for", " ", "Clique", " ", "3", " ", 
     RowBox[{"(", 
      RowBox[{"parity", " ", "1"}], ")"}], " ", "and", " ", "Clique", " ", 
     "4", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"parity", " ", "0"}], ")"}], "."}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cl1diag", "[", "M_", "]"}], ":=", 
     RowBox[{"cl1maker", "[", "M", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Outputs", " ", "the", " ", "matrix", " ", "sum", " ", "of", " ", "the", 
     " ", "first", " ", "commuting", " ", "clique", " ", "but", " ", 
     RowBox[{"diagonalized", ".", " ", "It"}], " ", "is", " ", "already", " ",
      "diagaonal", " ", "so", " ", "no", " ", "transformation", " ", "is", 
     " ", 
     RowBox[{"required", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cl2diag", "[", "M_", "]"}], ":=", 
     RowBox[{
      RowBox[{"h", "[", "M", "]"}], ".", 
      RowBox[{"cl2maker", "[", "M", "]"}], ".", 
      RowBox[{"h", "[", "M", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Outputs", " ", "the", " ", "matrix", " ", "sum", " ", "of", " ", "the", 
     " ", "second", " ", "commuting", " ", "clique", " ", "but", " ", 
     RowBox[{"diagonalized", ".", " ", "Requires"}], " ", "M", " ", 
     "hadamard", " ", "gates", " ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "on", " ", "each", " ", "qubit"}], ")"}], " ", "to", 
     " ", "be", " ", 
     RowBox[{"diagonalized", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cl3diag", "[", "M_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"M", ",", "1"}], "]"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"diagmat", "[", 
         RowBox[{"M", ",", "1"}], "]"}], ".", 
        RowBox[{"cl3maker", "[", "M", "]"}], ".", 
        RowBox[{"Transpose", "[", 
         RowBox[{"diagmat", "[", 
          RowBox[{"M", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Outputs", " ", "the", " ", "matrix", " ", "sum", " ", "of", " ", "the", 
     " ", "third", " ", "commuting", " ", "clique", " ", "but", " ", 
     RowBox[{"diagonalized", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cl4diag", "[", "M_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"M", ",", "1"}], "]"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"M", ",", "2"}], "]"}]}], ")"}], 
      RowBox[{
       RowBox[{"diagmat", "[", 
        RowBox[{"M", ",", "0"}], "]"}], ".", 
       RowBox[{"cl4maker", "[", "M", "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"diagmat", "[", 
         RowBox[{"M", ",", "0"}], "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Outputs", " ", "the", " ", "matrix", " ", "sum", " ", "of", " ", "the", 
     " ", "third", " ", "commuting", " ", "clique", " ", "but", " ", 
     RowBox[{"diagonalized", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dict1", "[", "M_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"tab", "=", 
       RowBox[{"cl1diag", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IntegerString", "[", 
           RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Length", "[", "tab", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "dict", " ", "functions", " ", "are", " ", "lists", " ", "of", " ", 
       "lists", " ", "that", " ", "have", " ", "the", " ", "bitstring", " ", 
       "and", " ", "associated", " ", "measurement", " ", "contribution", " ",
        "when", " ", "measuring", " ", "all", " ", "terms", " ", "in", " ", 
       "the", " ", "corresponding", " ", "clique", " ", "at", " ", 
       RowBox[{"once", ".", " ", 
        RowBox[{"They", "'"}]}], "ve", " ", "only", " ", "been", " ", 
       "tested", " ", "on", " ", "the", " ", "normal", " ", "M"}], "=", "2"}],
      ",", " ", 
     RowBox[{"W", "=", "0"}], ",", " ", 
     RowBox[{"\[Nu]a", "=", 
      RowBox[{"\[Nu]b", "=", "0"}]}], ",", " ", 
     RowBox[{"V", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", "3", "]"}], " ", 
       RowBox[{"example", ".", " ", "They"}], " ", 
       RowBox[{"worked", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"As", " ", "in"}], ",", " ", 
     RowBox[{
     "if", " ", "you", " ", "prepare", " ", "the", " ", "state", " ", "to", 
      " ", "measure", " ", "all", " ", "the", " ", "X", " ", "terms", " ", 
      "X_", "1"}], ",", " ", 
     RowBox[{
     "X_", "2", " ", "and", " ", "X_", "3", " ", "in", " ", "the", " ", 
      "encoded", " ", "LMG", " ", "Hamiltonian", " ", "and", " ", "measure", 
      " ", "000"}], ",", " ", 
     RowBox[{
     "then", " ", "you", " ", "consult", " ", "the", " ", "000", " ", "entry",
       " ", "in", " ", 
      RowBox[{
       RowBox[{"dict2", "[", "3", "]"}], ".", " ", "Similarly"}]}], ",", " ", 
     
     RowBox[{
     "for", " ", "the", " ", "state", " ", "to", " ", "measure", " ", "all", 
      " ", "terms", " ", "in", " ", "clique", " ", "3", " ", "and", " ", 
      "you", " ", "measure", " ", "101"}], ",", " ", 
     RowBox[{
     "then", " ", "you", " ", "consult", " ", "the", " ", "term", " ", 
      "attached", " ", "to", " ", "bitstring", " ", "101", " ", "in", " ", 
      RowBox[{
       RowBox[{"dict3", "[", "3", "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dict2", "[", "M_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"tab", "=", 
       RowBox[{"cl2diag", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IntegerString", "[", 
           RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Length", "[", "tab", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dict3", "[", "M_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"tab", "=", 
       RowBox[{"cl3diag", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IntegerString", "[", 
           RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Length", "[", "tab", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dict4", "[", "M_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"tab", "=", 
       RowBox[{"cl4diag", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IntegerString", "[", 
           RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
          RowBox[{"tab", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Length", "[", "tab", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"efcl1", "[", "M_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ints", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", "M"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"idenc", "[", "M", "]"}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"ints", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]], 
           RowBox[{"z1c", "[", "M", "]"}]}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"ints", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]], 
             RowBox[{"zjc", "[", 
              RowBox[{"M", ",", "j"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"ints", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "M"}], "]"}], "]"}]], 
           RowBox[{"zMc", "[", "M", "]"}]}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{
               RowBox[{"ints", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
               RowBox[{"ints", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}]], 
             RowBox[{"zijc", "[", 
              RowBox[{"M", ",", "j"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}], "]"}]}], ")"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Generates", " ", "the", " ", "matrix", " ", "from", " ", "adding", " ",
        "the", " ", "first", " ", "Clique", " ", "terms", " ", 
       RowBox[{"together", ".", " ", "Is"}], " ", "more", " ", "efficient", 
       " ", "than", " ", 
       RowBox[{"cldiag1", "[", "]"}]}], "..."}], " ", "I", " ", 
     RowBox[{"think", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"efcl2", "[", "M_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ints", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", "M"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xjc", "[", 
             RowBox[{"M", ",", "j"}], "]"}], "*", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"ints", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "M"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}], "]"}]}], ")"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generates", " ", "the", " ", "matrix", " ", "from", " ", "adding", " ", 
     "the", " ", "second", " ", "Clique", " ", "terms", " ", "together", " ", 
     "and", " ", 
     RowBox[{"diagonalizing", ".", " ", "Does"}], " ", "so", " ", "more", " ",
      "efficiently", " ", "than", " ", 
     RowBox[{"cl2diag", "[", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"tested", " ", "this"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"efcl3", "[", "M_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ints", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", "M"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ints2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"M", "-", "1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"M", "-", "1"}], ")"}]}], "-", "1"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"EvenQ", "[", "M", "]"}], "\[Equal]", "True"}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"ints", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}]], 
               RowBox[{"xzjc", "[", 
                RowBox[{"M", ",", 
                 RowBox[{
                  RowBox[{"2", "j"}], "-", "1"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"M", "/", "2"}]}], "}"}]}], "]"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"ints", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"2", "j"}]}], "]"}], "]"}]], 
               RowBox[{"(", 
                RowBox[{"-", 
                 RowBox[{"xzjc", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"2", "j"}]}], "]"}]}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"M", "/", "2"}]}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"ints2", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"i", "/", "2"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}]], 
               RowBox[{"xzjc", "[", 
                RowBox[{"M", ",", 
                 RowBox[{
                  RowBox[{"2", "j"}], "-", "1"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"M", "-", "1"}], ")"}], "/", "2"}]}], "}"}]}], 
             "]"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"ints2", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"i", "/", "2"}], "]"}], ",", 
                   RowBox[{"2", "j"}]}], "]"}], "]"}]], 
               RowBox[{"(", 
                RowBox[{"-", 
                 RowBox[{"xzjc", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"2", "j"}]}], "]"}]}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"M", "-", "1"}], ")"}], "/", "2"}]}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
     ")"}]}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generates", " ", "the", " ", "matrix", " ", "from", " ", "adding", " ", 
     "the", " ", "third", " ", "Clique", " ", "terms", " ", "together", " ", 
     "and", " ", 
     RowBox[{"diagonalizing", ".", " ", "Becomes"}], " ", "more", " ", 
     "efficient", " ", "than", " ", 
     RowBox[{"cl3diag", "[", "]"}], " ", "as", " ", "M", " ", 
     RowBox[{"rises", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"efcl4", "[", "M_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ints", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", "M"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ints2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"M", "-", "1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"M", "-", "1"}], ")"}]}], "-", "1"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ints2", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ints2", ",", "ints2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"EvenQ", "[", "M", "]"}], "\[Equal]", "True"}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"ints2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}]], 
               RowBox[{"xzjc", "[", 
                RowBox[{"M", ",", 
                 RowBox[{"2", "j"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{
                 RowBox[{"M", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"ints2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"2", "j"}]}], "]"}], "]"}]], 
               RowBox[{"(", 
                RowBox[{"-", 
                 RowBox[{"xzjc", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{
                    RowBox[{"2", "j"}], "+", "1"}]}], "]"}]}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{
                 RowBox[{"M", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"ints2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}]], 
               RowBox[{"xzjc", "[", 
                RowBox[{"M", ",", 
                 RowBox[{"2", "j"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"M", "-", "1"}], ")"}], "/", "2"}]}], "}"}]}], 
             "]"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"ints2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"2", "j"}]}], "]"}], "]"}]], 
               RowBox[{"(", 
                RowBox[{"-", 
                 RowBox[{"xzjc", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{
                    RowBox[{"2", "j"}], "+", "1"}]}], "]"}]}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"M", "-", "1"}], ")"}], "/", "2"}]}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
     ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generates", " ", "the", " ", "matrix", " ", "from", " ", "adding", " ", 
     "the", " ", "fourth", " ", "Clique", " ", "terms", " ", "together", " ", 
     "and", " ", 
     RowBox[{"diagonalizing", ".", " ", "Becomes"}], " ", "more", " ", 
     "efficient", " ", "than", " ", 
     RowBox[{"cl4diag", "[", "]"}], " ", "as", " ", "M", " ", 
     RowBox[{"rises", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"efdic1", "[", "M_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ints", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", "M"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IntegerString", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", "2", ",", "M"}], "]"}], ",", 
          RowBox[{
           RowBox[{"idenc", "[", "M", "]"}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"ints", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]], 
            RowBox[{"z1c", "[", "M", "]"}]}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"ints", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]], 
              RowBox[{"zjc", "[", 
               RowBox[{"M", ",", "j"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "2", ",", 
               RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"ints", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "M"}], "]"}], "]"}]], 
            RowBox[{"zMc", "[", "M", "]"}]}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{
                RowBox[{"ints", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
                RowBox[{"ints", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}]], 
              RowBox[{"zijc", "[", 
               RowBox[{"M", ",", "j"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}]}], ")"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Generates", " ", "the", " ", "dictionary", " ", "for", " ", "the", " ",
        "first", " ", 
       RowBox[{"Clique", ".", " ", "Does"}], " ", "so", " ", "more", " ", 
       "efficiently", " ", "than", " ", 
       RowBox[{"dict1", "[", "]"}]}], "..."}], " ", "I", " ", 
     RowBox[{"think", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"efdic2", "[", "M_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ints", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", "M"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IntegerString", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", "2", ",", "M"}], "]"}], ",", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xjc", "[", 
              RowBox[{"M", ",", "j"}], "]"}], "*", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"ints", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "M"}], "}"}]}], "]"}]}], "}"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}]}], ")"}]}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generates", " ", "the", " ", "dictionary", " ", "for", " ", "the", " ", 
     "second", " ", 
     RowBox[{"Clique", ".", " ", "Does"}], " ", "so", " ", "more", " ", 
     "efficiently", " ", "than", " ", 
     RowBox[{"dict2", "[", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"tested", " ", "this"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"efdic3", "[", "M_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ints", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", "M"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ints2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"M", "-", "1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"M", "-", "1"}], ")"}]}], "-", "1"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"EvenQ", "[", "M", "]"}], "\[Equal]", "True"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IntegerString", "[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "2", ",", "M"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"ints", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}]], 
                RowBox[{"xzjc", "[", 
                 RowBox[{"M", ",", 
                  RowBox[{
                   RowBox[{"2", "j"}], "-", "1"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"M", "/", "2"}]}], "}"}]}], "]"}], "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"ints", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"2", "j"}]}], "]"}], "]"}]], 
                RowBox[{"(", 
                 RowBox[{"-", 
                  RowBox[{"xzjc", "[", 
                   RowBox[{"M", ",", 
                    RowBox[{"2", "j"}]}], "]"}]}], ")"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"M", "/", "2"}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IntegerString", "[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "2", ",", "M"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"ints2", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"i", "/", "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}]], 
                RowBox[{"xzjc", "[", 
                 RowBox[{"M", ",", 
                  RowBox[{
                   RowBox[{"2", "j"}], "-", "1"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"M", "-", "1"}], ")"}], "/", "2"}]}], "}"}]}], 
              "]"}], "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"ints2", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"i", "/", "2"}], "]"}], ",", 
                    RowBox[{"2", "j"}]}], "]"}], "]"}]], 
                RowBox[{"(", 
                 RowBox[{"-", 
                  RowBox[{"xzjc", "[", 
                   RowBox[{"M", ",", 
                    RowBox[{"2", "j"}]}], "]"}]}], ")"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"M", "-", "1"}], ")"}], "/", "2"}]}], "}"}]}], 
              "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generates", " ", "the", " ", "dictionary", " ", "for", " ", "the", " ", 
     "third", " ", 
     RowBox[{"Clique", ".", " ", "Does"}], " ", "so", " ", "more", " ", 
     "efficiently", " ", "than", " ", 
     RowBox[{"dict3", "[", "]"}], " ", "as", " ", "M", " ", 
     RowBox[{"rises", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"efdic4", "[", "M_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ints", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", "M"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", "M"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ints2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"M", "-", "1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"M", "-", "1"}], ")"}]}], "-", "1"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ints2", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ints2", ",", "ints2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"EvenQ", "[", "M", "]"}], "\[Equal]", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IntegerString", "[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "2", ",", "M"}], "]"}], ",", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"ints2", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}]], 
                RowBox[{"xzjc", "[", 
                 RowBox[{"M", ",", 
                  RowBox[{"2", "j"}]}], "]"}]}], "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"ints2", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"2", "j"}]}], "]"}], "]"}]], 
                RowBox[{"(", 
                 RowBox[{"-", 
                  RowBox[{"xzjc", "[", 
                   RowBox[{"M", ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "+", "1"}]}], "]"}]}], ")"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{
                 RowBox[{"M", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IntegerString", "[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "2", ",", "M"}], "]"}], ",", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"ints2", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "-", "1"}]}], "]"}], "]"}]], 
                RowBox[{"xzjc", "[", 
                 RowBox[{"M", ",", 
                  RowBox[{"2", "j"}]}], "]"}]}], "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"ints2", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"2", "j"}]}], "]"}], "]"}]], 
                RowBox[{"(", 
                 RowBox[{"-", 
                  RowBox[{"xzjc", "[", 
                   RowBox[{"M", ",", 
                    RowBox[{
                    RowBox[{"2", "j"}], "+", "1"}]}], "]"}]}], ")"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"M", "-", "1"}], ")"}], "/", "2"}]}], "}"}]}], 
             "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"2", "^", "M"}]}], "}"}]}], "]"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generates", " ", "the", " ", "dictionary", " ", "for", " ", "the", " ", 
     "fourth", " ", 
     RowBox[{"Clique", ".", " ", "Does"}], " ", "so", " ", "more", " ", 
     "efficiently", " ", "than", " ", 
     RowBox[{"dict4", "[", "]"}], " ", "as", " ", "M", " ", 
     RowBox[{"rises", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputeater1", "[", "inp_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"emm", "=", 
       RowBox[{"Length", "[", "inp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"emm", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"idenc", "[", "1", "]"}], "+", 
         RowBox[{"2", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"inp", "[", 
            RowBox[{"[", "1", "]"}], "]"}]], 
          RowBox[{"zjc", "[", 
           RowBox[{"1", ",", "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"idenc", "[", "emm", "]"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"inp", "[", 
            RowBox[{"[", "1", "]"}], "]"}]], 
          RowBox[{"z1c", "[", "emm", "]"}]}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"inp", "[", 
              RowBox[{"[", "j", "]"}], "]"}]], 
            RowBox[{"zjc", "[", 
             RowBox[{"emm", ",", "j"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{"emm", "-", "1"}]}], "}"}]}], "]"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"inp", "[", 
            RowBox[{"[", "emm", "]"}], "]"}]], 
          RowBox[{"zMc", "[", "emm", "]"}]}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{
              RowBox[{"inp", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+", 
              RowBox[{"inp", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}]}]], 
            RowBox[{"zijc", "[", 
             RowBox[{"emm", ",", "j"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"emm", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
     ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"FOR", " ", "CLIQUE", " ", "1"}], ":", " ", 
     RowBox[{
     "Given", " ", "a", " ", "bitstring", " ", "in", " ", "list", " ", 
      "format", " ", 
      RowBox[{"(", 
       RowBox[{"e", ".", "g", ".", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ")"}], " ", "it", " ", 
      "will", " ", "output", " ", "the", " ", "proper", " ", "contribution", 
      " ", "to", " ", 
      RowBox[{"\[LeftAngleBracket]", "H", "\[RightAngleBracket]"}], " ", 
      "resulting", " ", "from", " ", "measuring", " ", "that", " ", 
      RowBox[{"bitstring", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputeater2", "[", "inp_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"emm", "=", 
       RowBox[{"Length", "[", "inp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xjc", "[", 
          RowBox[{"emm", ",", "j"}], "]"}], "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"inp", "[", 
           RowBox[{"[", "j", "]"}], "]"}]]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "emm"}], "}"}]}], "]"}]}], " ", ")"}]}], 
   
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"FOR", " ", "CLIQUE", " ", "2"}], ":", " ", 
     RowBox[{
     "Given", " ", "a", " ", "bitstring", " ", "in", " ", "list", " ", 
      "format", " ", 
      RowBox[{"(", 
       RowBox[{"e", ".", "g", ".", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ")"}], " ", "it", " ", 
      "will", " ", "output", " ", "the", " ", "proper", " ", "contribution", 
      " ", "to", " ", 
      RowBox[{"\[LeftAngleBracket]", "H", "\[RightAngleBracket]"}], " ", 
      "resulting", " ", "from", " ", "measuring", " ", "that", " ", 
      RowBox[{"bitstring", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputeater3", "[", "inp_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"emm", "=", 
       RowBox[{"Length", "[", "inp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"EvenQ", "[", "emm", "]"}], "\[Equal]", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"inp", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", "j"}], "-", "1"}], "]"}], "]"}]], 
            RowBox[{"xzjc", "[", 
             RowBox[{"emm", ",", 
              RowBox[{
               RowBox[{"2", "j"}], "-", "1"}]}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"inp", "[", 
              RowBox[{"[", 
               RowBox[{"2", "j"}], "]"}], "]"}]], 
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"xzjc", "[", 
               RowBox[{"emm", ",", 
                RowBox[{"2", "j"}]}], "]"}]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"emm", "/", "2"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ints2", "=", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"FromDigits", "[", 
               RowBox[{"inp", ",", "2"}], "]"}], "/", "2"}], "]"}], ",", "2", 
            ",", 
            RowBox[{"emm", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"ints2", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"2", "j"}], "-", "1"}], "]"}], "]"}]], 
             RowBox[{"xzjc", "[", 
              RowBox[{"emm", ",", 
               RowBox[{
                RowBox[{"2", "j"}], "-", "1"}]}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"ints2", "[", 
               RowBox[{"[", 
                RowBox[{"2", "j"}], "]"}], "]"}]], 
             RowBox[{"(", 
              RowBox[{"-", 
               RowBox[{"xzjc", "[", 
                RowBox[{"emm", ",", 
                 RowBox[{"2", "j"}]}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"emm", "/", "2"}]}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}]}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"FOR", " ", "CLIQUE", " ", "3"}], ":", " ", 
     RowBox[{
     "Given", " ", "a", " ", "bitstring", " ", "in", " ", "list", " ", 
      "format", " ", 
      RowBox[{"(", 
       RowBox[{"e", ".", "g", ".", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ")"}], " ", "it", " ", 
      "will", " ", "output", " ", "the", " ", "proper", " ", "contribution", 
      " ", "to", " ", 
      RowBox[{"\[LeftAngleBracket]", "H", "\[RightAngleBracket]"}], " ", 
      "resulting", " ", "from", " ", "measuring", " ", "that", " ", 
      RowBox[{"bitstring", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputeater4", "[", "inp_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"emm", "=", 
       RowBox[{"Length", "[", "inp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"inp2", "=", 
       RowBox[{"IntegerDigits", "[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"FromDigits", "[", 
            RowBox[{"inp", ",", "2"}], "]"}], ",", 
           SuperscriptBox["2", 
            RowBox[{"emm", "-", "1"}]]}], "]"}], ",", "2", ",", 
         RowBox[{"emm", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"inp2", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "j"}], "-", "1"}], "]"}], "]"}]], 
          RowBox[{"xzjc", "[", 
           RowBox[{"emm", ",", 
            RowBox[{"2", "j"}]}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"inp2", "[", 
            RowBox[{"[", 
             RowBox[{"2", "j"}], "]"}], "]"}]], 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"xzjc", "[", 
             RowBox[{"emm", ",", 
              RowBox[{
               RowBox[{"2", "j"}], "+", "1"}]}], "]"}]}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"emm", "-", "1"}], ")"}], "/", "2"}]}], "}"}]}], "]"}]}], 
     ")"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"FOR", " ", "CLIQUE", " ", "4"}], ":", " ", 
      RowBox[{
      "Given", " ", "a", " ", "bitstring", " ", "in", " ", "list", " ", 
       "format", " ", 
       RowBox[{"(", 
        RowBox[{"e", ".", "g", ".", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ")"}], " ", "it", " ", 
       "will", " ", "output", " ", "the", " ", "proper", " ", "contribution", 
       " ", "to", " ", 
       RowBox[{"\[LeftAngleBracket]", "H", "\[RightAngleBracket]"}], " ", 
       "resulting", " ", "from", " ", "measuring", " ", "that", " ", 
       RowBox[{"bitstring", "."}]}]}], " ", "*)"}]}]}]}]], "Input",
 CellFrame->{{0, 0}, {0, 3}},
 CellChangeTimes->{{3.847877297343104*^9, 3.847877307056897*^9}, {
  3.847878371791305*^9, 3.847878384693392*^9}, {3.847878426431176*^9, 
  3.847878431411798*^9}, {3.84788086635632*^9, 3.847880919347905*^9}, {
  3.847881589240901*^9, 3.847881590182107*^9}, {3.847881783394623*^9, 
  3.8478817838919*^9}, {3.849175139575777*^9, 3.8491751993949203`*^9}},
 CellTags->"runfirst",
 CellLabel->"In[61]:=",ExpressionUUID->"b83b1c51-17f3-4257-a51a-c87cd9df490c"]
},
WindowSize->{808, 681},
WindowMargins->{{150, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"62f1d4a9-5a4a-4ab9-b81e-573203d25aa4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "runfirst"->{
  Cell[41345, 1066, 139449, 3749, 9085, "Input",ExpressionUUID->"b83b1c51-17f3-4257-a51a-c87cd9df490c",
   CellTags->"runfirst"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"runfirst", 181141, 4828}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1790, 38, 314, "Text",ExpressionUUID->"cae858d2-540d-4608-8d21-c3f0aeb362fc"],
Cell[2351, 60, 719, 13, 123, "Text",ExpressionUUID->"6da49c1c-df50-4d22-8483-42ac4fc22049"],
Cell[3073, 75, 14528, 371, 1383, "Input",ExpressionUUID->"084df1b7-e6b3-4160-9f31-0113e7ea164e"],
Cell[CellGroupData[{
Cell[17626, 450, 9433, 241, 949, "Input",ExpressionUUID->"7027a292-97fc-4674-9fcf-00f9b2c60ed1"],
Cell[CellGroupData[{
Cell[27084, 695, 1391, 39, 87, "Print",ExpressionUUID->"82fc8dd0-2728-4152-bf33-224a00cf93d9"],
Cell[28478, 736, 1386, 39, 87, "Print",ExpressionUUID->"bbfe762e-e9af-4131-8bee-3158a2b9a7a9"],
Cell[29867, 777, 1387, 39, 87, "Print",ExpressionUUID->"f02541e2-1a01-4a92-97c2-51dfcd67c389"]
}, Open  ]],
Cell[31269, 819, 2489, 60, 345, "Output",ExpressionUUID->"f3e1a9ff-225c-4a9c-85c2-62022d7474c5"],
Cell[33761, 881, 2666, 62, 345, "Output",ExpressionUUID->"d1fa29c3-ffc3-4f6f-a4e4-f8f47fe55de3"],
Cell[36430, 945, 2577, 62, 345, "Output",ExpressionUUID->"1a5f1280-ee5d-4a4e-b25c-92fa57e25200"],
Cell[39010, 1009, 2320, 54, 326, "Output",ExpressionUUID->"0a1088fc-08af-4ebb-a826-50954aedab69"]
}, Open  ]],
Cell[41345, 1066, 139449, 3749, 9085, "Input",ExpressionUUID->"b83b1c51-17f3-4257-a51a-c87cd9df490c",
 CellTags->"runfirst"]
}
]
*)

